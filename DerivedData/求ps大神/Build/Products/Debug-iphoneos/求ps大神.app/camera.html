<html>
    <head>
        <meta name = "viewport" content = "initial-scale = 1.0, user-scalable = no" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

        <link rel="stylesheet" href="jqmobile/demotivation.min.css" />
        <link rel="stylesheet" href="jqmobile/jquery.mobile.structure-1.1.0.min.css" />
        <script src="jqmobile/jquery-1.7.2.min.js"></script>
        <script src="jqmobile/jquery.mobile-1.1.0.min.js"></script>
        <script type="text/javascript" src="NKit.js"></script>
    </head>
    <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <script>
        var navController = new NKNavigationController();
        navController.setTintColor(127,72,42);
        navController.setTitle("我的照片");
        navController.addNavigationItem("拍照", "takePicture","camera_plus.png");
        navController.show();
        var selectedImage;
        function takePicture()
        {
           showImageSelectionSheet();
        }
        function showImageSelectionSheet(){
            var sheet = new NKAlertSheet();
            sheet.init("imageSelectionSheetButtonPressed");
            sheet.addButtonWithTitle("拍照");
            sheet.addButtonWithTitle("从手机相册选择");
            sheet.addButtonWithTitle("取消");
            sheet.setTitle("拍照选择");
            sheet.show();
        }
        function imageSelected(imageObj){
            if (!imageObj)return;
            selectedImage = imageObj;
            var obj = document.getElementById('imageHolder');
            obj.innerHTML = '<img src="data:image/jpg;base64,' + selectedImage.getBase64(1) + '"/>';
            selectedImage.saveToLibrary();
            $.post("http://172.31.182.42:8088/ios/upload", { name: selectedImage.getBase64(0.8)} );
             NKAlert("", "Successfully");
        }
        
        function imageSelectionSheetButtonPressed(index){
            if (index == 2)return;
            var source = 'camera';
            if (index == 1)source = 'PhotoLibrary';
            NKPickImageObject('imageSelected', source);
        }
        </script>
    <script>
        document.write('<div style="width: 320px; height: 320px;border: 1px solid gray;" id="imageHolder" onclick="showImageSelectionSheet();">test</div>');
        </script>
    <body>
        <center>
            <div id="mypicture"></div>
        </center>
   </body>
</html>